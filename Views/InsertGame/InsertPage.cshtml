@model GameModel;

@{
    ViewData["Title"] = "Adicionar Jogo";
}

<div class="max-w-4xl mx-auto">
    <div class="mb-8">
        <h1 class="text-3xl font-bold text-gray-800 mb-2">Adicionar novo jogo</h1>
        <p class="text-gray-600">Preencha as informa√ß√µes do jogo para adicionar √† sua biblioteca</p>
    </div>

    <div class="card">
        <div class="card-header">
            <h2 class="text-xl font-semibold text-gray-800">Informa√ß√µes do jogo</h2>
        </div>
        <div class="card-body">
            <form method="post" asp-controller="InsertGame" asp-action="CreateGame" id="gameRegister" enctype="multipart/form-data">
                <div class="grid md:grid-cols-2 gap-6">
                    <!-- esquerda -->
                    <div class="space-y-6">
                        <div>
                            <label class="form-label" for="Name">
                                Nome do jogo *
                            </label>
                            <input type="text" 
                                   asp-for="Name" 
                                   value="@Model?.Name" 
                                   class="form-input"
                                   placeholder="Ex: The Legend of Zelda: Breath of the Wild"
                                   required />
                            <span asp-validation-for="Name" class="text-red-500 text-sm"></span>
                        </div>

                        <div>
                            <label class="form-label" for="Genre">
                                G√™nero *
                            </label>
                            <input type="text" 
                                   asp-for="Genre" 
                                   value="@Model?.Genre" 
                                   class="form-input"
                                   placeholder="Ex: Action RPG, Platformer, FPS"
                                   required />
                            <span asp-validation-for="Genre" class="text-red-500 text-sm"></span>
                        </div>

                        <div>
                            <label class="form-label" for="Developer">
                                Desenvolvedor *
                            </label>
                            <input type="text" 
                                   asp-for="Developer" 
                                   value="@Model?.Developer" 
                                   class="form-input"
                                   placeholder="Ex: Nintendo"
                                   required />
                            <span asp-validation-for="Developer" class="text-red-500 text-sm"></span>
                        </div>

                        <div>
                            <label class="form-label" for="RealeseDate">
                                Data de Lan√ßamento *
                            </label>
                            <input type="date" 
                                   asp-for="RealeseDate" 
                                   value="@(Model?.RealeseDate.ToString("yyyy-MM-dd"))" 
                                   class="form-input"
                                   required />
                            <span asp-validation-for="RealeseDate" class="text-red-500 text-sm"></span>
                        </div>
                    </div>

                    <div class="space-y-6">
                        <div>
                            <label class="form-label" for="Description">
                                Descri√ß√£o
                            </label>
                            <textarea asp-for="Description" 
                                      class="form-input h-32 resize-none"
                                      placeholder="Descreva o jogo, sua hist√≥ria, gameplay ou suas impress√µes...">@Model?.Description</textarea>
                            <span asp-validation-for="Description" class="text-red-500 text-sm"></span>
                        </div>

                        <div>
                            <label class="form-label">
                                Banner do jogo (500x1500px recomendado)
                            </label>
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-pink-400 transition-colors duration-200">
                                <input type="file" 
                                       id="bannerInput"
                                       asp-for="BannerImgUrl" 
                                       accept="image/*"
                                       class="hidden" />
                                <div id="bannerPreview" class="hidden">
                                    <img id="bannerImg" class="max-h-32 mx-auto rounded-lg shadow-md mb-3" />
                                    <button type="button" onclick="clearBanner()" class="text-red-500 text-sm hover:text-red-700">
                                        remover banner
                                    </button>
                                </div>
                                <div id="bannerPlaceholder">
                                    <svg class="w-12 h-12 text-gray-400 mx-auto mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                    </svg>
                                    <p class="text-gray-600 mb-2">Clique para selecionar o banner</p>
                                    <button type="button" onclick="document.getElementById('bannerInput').click()" class="btn-secondary">
                                        Escolher arquivo
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div>
                            <label class="form-label">
                                √çcone do Jogo (1:1 recomendado)
                            </label>
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-pink-400 transition-colors duration-200">
                                <input type="file" 
                                       id="iconInput"
                                       asp-for="IconImg" 
                                       accept="image/*"
                                       class="hidden" />
                                <div id="iconPreview" class="hidden">
                                    <img id="iconImg" class="w-20 h-20 mx-auto rounded-lg shadow-md mb-3 object-cover" />
                                    <button type="button" onclick="clearIcon()" class="text-red-500 text-sm hover:text-red-700">
                                        Remover √≠cone
                                    </button>
                                </div>
                                <div id="iconPlaceholder">
                                    <svg class="w-12 h-12 text-gray-400 mx-auto mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                    </svg>
                                    <p class="text-gray-600 mb-2">Clique para selecionar o √≠cone</p>
                                    <button type="button" onclick="document.getElementById('iconInput').click()" class="btn-secondary">
                                        Escolher arquivo
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- aqui ele puxa coisa do base64 -->
                <input type="hidden" id="bannerBase64" name="BannerImgUrl" />
                <input type="hidden" id="iconBase64" name="IconImg" />

                <div class="flex flex-col sm:flex-row gap-4 justify-end mt-8 pt-6 border-t border-gray-200">
                    <a asp-controller="InsertGame" asp-action="Index" class="btn-secondary text-center">
                        Cancelar
                    </a>
                    <button type="submit" form="gameRegister" class="btn-primary">
                        üéÆ Adicionar jogo
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // aqui ele vai dar upload no banner
        document.getElementById('bannerInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const base64 = e.target.result;
                    document.getElementById('bannerBase64').value = base64;
                    document.getElementById('bannerImg').src = base64;
                    document.getElementById('bannerPreview').classList.remove('hidden');
                    document.getElementById('bannerPlaceholder').classList.add('hidden');
                };
                reader.readAsDataURL(file);
            }
        });

        // aqui ele vai dar upload no √≠cone
        document.getElementById('iconInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const base64 = e.target.result;
                    document.getElementById('iconBase64').value = base64;
                    document.getElementById('iconImg').src = base64;
                    document.getElementById('iconPreview').classList.remove('hidden');
                    document.getElementById('iconPlaceholder').classList.add('hidden');
                };
                reader.readAsDataURL(file);
            }
        });

        // deleta o banner
        function clearBanner() {
            document.getElementById('bannerInput').value = '';
            document.getElementById('bannerBase64').value = '';
            document.getElementById('bannerPreview').classList.add('hidden');
            document.getElementById('bannerPlaceholder').classList.remove('hidden');
        }

        // deleta o √≠cone
        function clearIcon() {
            document.getElementById('iconInput').value = '';
            document.getElementById('iconBase64').value = '';
            document.getElementById('iconPreview').classList.add('hidden');
            document.getElementById('iconPlaceholder').classList.remove('hidden');
        }
    </script>
}

